# ویژوالایزر و تحلیلگر گراف کیلی

این اسکریپت پایتون ابزاری برای تولید، نمایش و تحلیل گراف‌های کیلی فراهم می‌کند که به ویژه روی ویژگی‌هایی مانند وجود سیکل‌های همیلتونی تمرکز دارد. گراف‌های کیلی در نظریه گروه‌ها برای مطالعه ساختار و روابط عناصر درون یک گروه مفید هستند. این اسکریپت همچنین به شما امکان می‌دهد مسیرهای مولد را نمایش دهید و وجود سیکل‌های همیلتونی را بررسی کنید.

## تعریف الگوریتم

الگوریتم تولید گراف کیلی در این اسکریپت برای ساخت یک گراف که ساختار گروه را بر اساس مجموعه‌ای از مولدها نشان می‌دهد طراحی شده است. در اینجا توضیح گام به گام این الگوریتم با ارجاع به کد مربوطه آمده است:

### تولید گراف کیلی (`cayley_graph(group, generators)`)
1. **ایجاد گره‌ها و یال‌ها**:
   - در تابع `cayley_graph(group, generators)`، یک دیکشنری `G` ایجاد می‌شود که هر کلید نمایانگر یک عنصر از گروه است و مقدار مربوط به آن لیستی است که همسایه‌های آن گره را ذخیره می‌کند. همچنین دیکشنری دیگری به نام `edges_by_generator` برای ذخیره یال‌های هر مولد ایجاد می‌شود:
     ```python
     G = {g: [] for g in group}  # ذخیره همسایه‌ها برای هر گره
     edges_by_generator = {gen: [] for gen in generators}  # یال‌ها
     ```

2. **افزودن یال‌ها با استفاده از مولدها**:
   - اسکریپت برای هر عنصر (`g`) در گروه و هر مولد (`s`) همسایه مربوطه (`h`) را محاسبه می‌کند. عملیات `(g + s) % len(group)` تضمین می‌کند که عنصر حاصل در محدوده گروه باقی بماند و ساختاری دایره‌ای ایجاد کند. اگر همسایه (`h`) قبلاً در لیست همسایه‌های `g` وجود نداشته باشد، به آن اضافه می‌شود:
     ```python
     for g in group:
         for s in generators:
             h = (g + s) % len(group)  # جمع به صورت مدولار
             if h not in G[g]:
                 G[g].append(h)
             if (g, h) not in edges_by_generator[s] and (h, g) not in edges_by_generator[s]:
                 edges_by_generator[s].append((g, h))  # ذخیره یال‌ها
     ```
   - این عملیات اطمینان می‌دهد که هر گره به همسایه‌های خود بر اساس مولدهای داده‌شده متصل است و هر یال فقط یک‌بار برای هر مولد ذخیره می‌شود.

3. **اجتناب از یال‌های تکراری**:
   - برای جلوگیری از ایجاد یال‌های تکراری، اسکریپت بررسی می‌کند که آیا یک یال قبلاً بین دو گره وجود دارد یا خیر و سپس آن را به `edges_by_generator` اضافه می‌کند.

### تشخیص سیکل همیلتونی (`has_hamiltonian_cycle(G)`)
الگوریتم تشخیص سیکل همیلتونی با استفاده از روش برگشت‌پذیری (Backtracking) پیاده‌سازی شده است:

1. **تعریف تابع برگشت‌پذیر**:
   - تابع `has_hamiltonian_cycle(G)` یک تابع تو در تو به نام `backtrack(path)` تعریف می‌کند که به صورت بازگشتی سعی در ساخت مسیری دارد که هر گره را دقیقاً یک‌بار بازدید کند. فراخوانی اولیه از هر گره ممکن در گراف شروع می‌شود:
     ```python
     def has_hamiltonian_cycle(G):
         nodes = list(G.keys())
         def backtrack(path):
             if len(path) == len(nodes):
                 if path[0] in G[path[-1]]:
                     print("سیکل همیلتونی وجود دارد:", path + [path[0]])
                     return True
                 return False
             current = path[-1]
             for neighbor in G[current]:
                 if neighbor not in path:
                     if backtrack(path + [neighbor]):
                         return True
             return False
     ```

2. **کاوش بازگشتی**:
   - تابع `backtrack` به افزودن گره‌ها به مسیر جاری ادامه می‌دهد تا زمانی که همه گره‌ها بازدید شوند. اگر مسیر به گره آغازین بازگردد و سیکل تشکیل شود، سیکل همیلتونی چاپ می‌شود.

3. **شروع از هر گره**:
   - این تابع تلاش می‌کند سیکل همیلتونی را از هر گره در گراف شروع کند (`for start_node in nodes:`). اگر سیکلی پیدا شود، `True` بازگردانده می‌شود و در غیر این صورت تلاش ادامه پیدا می‌کند تا همه گره‌ها آزمایش شوند:
     ```python
     for start_node in nodes:
         if backtrack([start_node]):
             return True
     print("هیچ سیکل همیلتونی یافت نشد.")
     return False
     ```

این روش برگشت‌پذیری برای گراف‌های کوچک مناسب است اما برای گراف‌های بزرگ کارا نیست زیرا تعداد مسیرهای ممکن به صورت نمایی با اندازه گراف رشد می‌کند.

### خلاصه
- **ساخت گراف**: گره‌ها نمایانگر عناصر گروه هستند و یال‌ها با اعمال مولدها تشکیل می‌شوند.
- **رنگ‌آمیزی یال‌ها**: هر مولد مجموعه‌ای مجزا از یال‌ها تعریف می‌کند که جداگانه ذخیره و با رنگ‌های مختلف نمایش داده می‌شوند.
- **تشخیص سیکل**: تشخیص سیکل همیلتونی با استفاده از برگشت‌پذیری انجام می‌شود که تمام مسیرهای ممکن را بررسی می‌کند.
- **ارجاعات کد**: توابع اصلی عبارتند از `cayley_graph(group, generators)` برای تولید گراف و `has_hamiltonian_cycle(G)` برای تشخیص سیکل.

## ویژگی‌ها

1. **تولید گراف کیلی**: تابع `cayley_graph(group, generators)` گراف کیلی را برای یک گروه و مولدهای آن تولید می‌کند.
2. **نمایش گراف با یال‌های رنگی**: تابع `draw_graph_with_colored_edges(G, edges_by_generator)` گراف کیلی را با استفاده از `matplotlib` و `networkx` نمایش می‌دهد.
3. **نمایش مسیرهای مولد**: تابع `print_generator_paths_text(generators, group_size)` نمایش متنی مسیرهای تولید شده توسط هر مولد را چاپ می‌کند.
4. **تشخیص سیکل همیلتونی**: تابع `has_hamiltonian_cycle(G)` بررسی می‌کند که آیا سیکل همیلتونی در گراف کیلی وجود دارد یا خیر.

## نیازمندی‌ها

- پایتون 3.x
- `matplotlib`
- `networkx`

می‌توانید وابستگی‌ها را با دستور زیر نصب کنید:

```sh
pip install matplotlib networkx
```

## استفاده

1. **تعریف گروه و مولدها**: گروهی به صورت لیست عناصر و مولدهای مربوطه تعریف کنید. برای مثال:

    ```python
    group = list(range(4))  # عناصر گروه: 0، 1، 2، 3
    generators = [1, 2]  # مولدها
    ```

2. **تولید گراف کیلی**: از تابع `cayley_graph(group, generators)` برای تولید گراف استفاده کنید.

3. **نمایش گراف**: با فراخوانی `draw_graph_with_colored_edges(G, edges_by_generator)` گراف کیلی را با رنگ‌های مختلف نمایش دهید.

4. **نمایش مسیرهای مولد**: از `print_generator_paths_text(generators, len(group))` برای نمایش مسیرهای مولد استفاده کنید.

5. **تشخیص سیکل همیلتونی**: با استفاده از `has_hamiltonian_cycle(G)` بررسی کنید که آیا سیکل همیلتونی در گراف وجود دارد یا خیر.

## مثال

مثال زیر نحوه استفاده از اسکریپت را نشان می‌دهد:

```python
# تعریف گروه و مولدها
group = list(range(4))  # عناصر گروه: 0، 1، 2، 3
generators = [1, 2]  # مولدها

# تولید گراف کیلی
G, edges_by_generator = cayley_graph(group, generators)

# نمایش گراف کیلی با یال‌های رنگی
draw_graph_with_colored_edges(G, edges_by_generator)

# نمایش مسیرهای مولد
print_generator_paths_text(generators, len(group))

# بررسی سیکل همیلتونی
has_hamiltonian_cycle(G)
```

## خروجی

- **نمایش گراف**: گرافی دایره‌ای با گره‌ها و یال‌ها رسم می‌شود که رنگ‌های مختلف یال‌ها نمایانگر مولدهای مختلف هستند.
- **مسیرهای مولد**: نمایش متنی مسیر هر مولد از میان گروه.
- **تشخیص سیکل همیلتونی**: چاپ نتیجه‌ی وجود یا عدم وجود سیکل همیلتونی.

## نکات

- این اسکریپت با گروه‌های جمعی به صورت مدولار کار می‌کند. می‌توانید عملیات گروه را به دلخواه برای انواع مختلف گروه‌ها تغییر دهید.
- تشخیص سیکل همیلتونی با استفاده از الگوریتم برگشت‌پذیری پیاده‌سازی شده است که ممکن است برای گروه‌های بزرگ کارا نباشد.

## لایسنس

این پروژه تحت لایسنس MIT ارائه می‌شود. می‌توانید آن را برای پروژه‌های خود تغییر داده و استفاده کنید.

## مشارکت‌ها

مشارکت‌ها، مشکلات و درخواست‌های ویژگی خوش‌آمدند! لطفاً یک issue باز کنید یا یک pull request ایجاد کنید.

